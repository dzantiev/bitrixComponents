# Список элементов

Компонент работает на основе метода [CIBlockElement::GetList](https://dev.1c-bitrix.ru/api_help/iblock/classes/ciblockelement/getlist.php).

## Принимаемые параметры

Можно передать все стандартные параметры ```CIBlockElement::GetList``` ___кроме  arNavStartParams и arSelectFields___:

- ***sort***   - параметр **arOrder** для метода ```CIBlockElement::GetList```
- ***filter*** - параметр **arFilter** для метода ```CIBlockElement::GetList```
- ***group***  - параметр **arGroupBy** для метода ```CIBlockElement::GetList```

Так же можно передать параметры:

- ***props***        - массив символьных кодов свойств, которые надо достать для элементов.
*<u>Внимание. Этот параметр работает только при наличии в параметре filter ключа IBLOCK_ID</u>*
- ***page***         - текущая страница пагинации
- ***count***        - количество элементов на странице
- ***pagn_tpl***     - название шаблона для пагинации (для компонента bitrix:system.pagenavigation)
- ***load_section*** - если true, то для элементов будет подгружаться информация о родительской секции элемента (в том числе пользовательские поля)
- ***images***       - массив [настроек](#настройка-обработки-изображений) для обработки изображений.
- ***load_price***   - если true, будет [подгружаться цена](#подгрузка-цены).

Пример использования
```php
$APPLICATION->IncludeCOmponent(
	'odva:elements',
	'',
	[
		'props'              => ['IMAGE', 'IMAGES'],
		'filter'             => ['IBLOCK_ID' => 1],
		'page'               => 1,
		'count'              => 0,
		'pagn_tpl'           => '',
		'load_section'       => true,
		'images'             => [
			'IMAGES' => [
				'small' => [200, 200]
			],
			'IMAGE' => [
				'small' => [200, 200]
			]
		],
		'load_price'         => true,
	]
);
```


## Подгрузка цены

Цена загружается с помощью метода [CCatalogProduct::GetOptimalPrice](https://dev.1c-bitrix.ru/api_help/catalog/classes/ccatalogproduct/ccatalogproduct__getoptimalprice.7c16046d.php),
но отдается только часть массива - ключ RESULT_PRICE, который содержит поля:

- "PRICE_TYPE_ID"  => ID типа цены
- "BASE_PRICE"     => исходная цена
- "DISCOUNT_PRICE" => цена со скидкой
- "CURRENCY"       => валюта результата
- "DISCOUNT"       => величина скидки
- "PERCENT"        => процент скидки
- "VAT_RATE"       => величина ставки НДС в процентах
- "VAT_INCLUDED"   => включен ли НДС в цену (Y/N) (в магазин всегда отдаются цены с включенным НДС)


## Настройка обработки изображений

Массив images - ***обязательно*** ассоциативный, где

- ключ - код поля, которое надо обработать. Ключи DETAIL_PICTURE и PREVIEW_PICTURE автоматически воспринимаются как стандартные анонс
и детальная картинка. Остальные ищутся в массиве свойств.
- значение - массив настроек для изображения. Это тоже ***обязательно*** ассоциативный массив, где
	- ключ - код, с которым будет добавлена картинка в результирующий массив картинок
	- значение - массив, в котором ***первые два значения*** - ширина и высота для обрезания картинки - их нужно ***обязательно*** передать.
	Кроме того можно передать третий параметр - тип обрезания resizeType
	(см. [документацию по обрезанию картинок](https://dev.1c-bitrix.ru/api_help/main/reference/cfile/resizeimageget.php)).

*Коды свойств, которые передаются в images, *обязательно* нужно передать так же в *props*, иначе они не будут подгруженны и соответственно не обработаны.*