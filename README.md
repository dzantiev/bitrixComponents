# Компонент формы

Компонент предназначен для обработки форм и сохранения отправленных данных в инфоблок.

<hr>
Парамерты компонента:

- ___IBLOCK_ID___ - ID инфоблока, в который нужно сохранять данные, __обязательный__ параметр
- ___ELEMENT_NAME___ - название нового элемента инфоблока, по умолчанию будет ставиться "Новый элемент"
- ___PROTECTED_PARAMS___ - параметры, которые нужно защитить от подделки пользователем. Как работает - описано ниже
- ___REQUIRED_FIELDS___ - определяет, какие поля формы обязательны для заполнения

<hr>
Пример подключения:

```php
//подключения компонента
$APPLICATION->IncludeComponent(
	'odva:odva.form',
	'.default',
	[
		'IBLOCK_ID' => 1,
		'ELEMENT_NAME' => 'Новая заявка',
		'REQUIRED_FIELDS' => ['EMAIL'],
        'PROTECTED_PARAMS' => ['REQUIRED_FIELDS']
	]
);
```

<hr>
Как передавать данные на сервер.

Запрос отправляется к отдельному файлу, путь к нему хранится в переменной ```$arResult['PATH_AJAX']``` в шаблоне.

На сервер данные должны приходить с такими же именами, какими названы свойства инфоблока. То есть, если у инфоблока есть свойство ```NAME```, то в форме поле ввода должно называться ```NAME``` (или параметр при сборке данных в ajax-запросе).

___Кроме данных на сервер надо обязательно отправлять параметр ```TOKEN```. В нем хранится набор защищенных параметров. Без этого параметра форма будет возвращать ошибку.___

<hr>
Как работает защита параметров.

Параметры, которые нужно защитить от подделки пользователем, нужно передать в параметр ```PROTECTED_PARAMS```. Из этих данных сформулируется специальный хеш, который в ```$arResult``` доступен как ключ ```TOKEN```. Его надо обятально отправлять на сервер.

По умолчанию там уже зашиты параметры ```IBLOCK_ID``` и ```ELEMENT_NAME```. Кроме них можно отправлять какие то свои параметры. Самый простой пример - защита параметра ```REQUIRED_FIELDS```. Но можно передавать любые параметры, которые есть в ```$arParams```.